From 1d550b33e9c083140e453cc19389d7966e888a14 Mon Sep 17 00:00:00 2001
From: Walter Bender <walter@sugarlabs.org>
Date: Thu, 12 Sep 2013 12:24:21 -0400
Subject: [PATCH] Add maximim_instances field to activity.info

---
 src/sugar3/bundle/activitybundle.py | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/src/sugar3/bundle/activitybundle.py b/src/sugar3/bundle/activitybundle.py
index 1443cd9..268092f 100644
--- a/src/sugar3/bundle/activitybundle.py
+++ b/src/sugar3/bundle/activitybundle.py
@@ -108,6 +108,7 @@ class ActivityBundle(Bundle):
         self._tags = None
         self._activity_version = '0'
         self._summary = None
+        self._maximum_instances = None
 
         info_file = self.get_file('activity/activity.info')
         if info_file is None:
@@ -173,6 +174,16 @@ class ActivityBundle(Bundle):
         if cp.has_option(section, 'summary'):
             self._summary = cp.get(section, 'summary')
 
+        if cp.has_option(section, 'maximum_instances'):
+            maximum_instances = cp.get(section, 'maximum_instances')
+            try:
+                self._maximum_instances = int(maximum_instances)
+            except ValueError:
+                logging.error(
+                    'Activity bundle %s has invalid maximum_instances %s' %
+                    (self._path, maximum_instances))
+                self._maximum_instances = None
+
     def _get_linfo_file(self):
         # Using method from gettext.py, first find languages from environ
         languages = []
@@ -273,6 +284,10 @@ class ActivityBundle(Bundle):
         """Get the summary that describe the activity"""
         return self._summary
 
+    def get_maximum_instances(self):
+        """Get the summary that describe the activity"""
+        return self._maximum_instances
+
     def get_show_launcher(self):
         """Get whether there should be a visible launcher for the activity"""
         return self._show_launcher
-- 
1.8.3.1

